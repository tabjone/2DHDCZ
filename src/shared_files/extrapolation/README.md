The extrapolation here is mostly for 2D arrays and our 2D foreground. This needs to be changed to a general version.